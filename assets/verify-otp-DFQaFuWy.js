import{c as T,u as N,r as n,j as e,T as r,F as v,h as b,k as w,L as O}from"./react-vendor-AsFLCtLt.js";import{o as E,b as P,j as d}from"./ui-vendor-vFVSZp0F.js";import{g as S}from"./errors-Ca1wdunW.js";import{o as R}from"./validation-C3ihj2kc.js";import{O as l,R as g,a as V}from"./constants-3f2xZCRM.js";import"./i18n-vendor-Bu7WbbtU.js";function M(){const{t}=T(),u=N(),[c,m]=n.useState(""),[i,x]=n.useState(0),h=n.useRef(null);n.useEffect(()=>{c.length===l&&h.current&&setTimeout(()=>{var s;(s=h.current)==null||s.submitForm()},100)},[c]),n.useEffect(()=>{if(i>0){const s=setTimeout(()=>{x(o=>o-1)},1e3);return()=>clearTimeout(s)}},[i]);const y=async s=>{try{if(await new Promise(o=>setTimeout(o,1500)),s.otp.length!==l)throw new Error("Invalid OTP");d({title:t("Success"),color:"success",description:t("OTP verified successfully"),timeout:2e3,shouldShowTimeoutProgress:!0}),u(g.LOGIN)}catch(o){const a=S(o,t("Invalid OTP. Please try again"));k(t,a),m("")}},j=async()=>{if(!(i>0))try{await new Promise(s=>setTimeout(s,500)),x(V),m(""),d({title:t("Code sent"),color:"success",description:t("A new code has been sent to your email"),timeout:3e3,shouldShowTimeoutProgress:!0})}catch{d({title:t("Error"),color:"danger",description:t("Failed to resend code. Please try again"),timeout:3e3,shouldShowTimeoutProgress:!0})}};return e.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-3xl font-bold leading-tight tracking-tight text-center",children:e.jsx(r,{children:"Verify your code"})}),e.jsx("p",{className:"text-sm text-gray-500 font-medium mb-8 text-center",children:e.jsx(r,{children:"Enter the 6-digit code we sent to your email address"})})]}),e.jsx(v,{innerRef:h,initialValues:{otp:""},validationSchema:C(t),onSubmit:y,children:({isSubmitting:s,setFieldValue:o,errors:a,touched:f})=>e.jsxs(w,{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(E,{length:l,value:c,onValueChange:p=>{m(p),o("otp",p)},isInvalid:f.otp&&!!a.otp,errorMessage:f.otp&&a.otp?t(a.otp):void 0,classNames:{base:"justify-center"},"aria-label":t("Enter verification code"),autoFocus:!0})}),e.jsxs("p",{className:"text-center text-xs text-gray-500 mt-2",children:[e.jsx(r,{children:"Didn't receive the code?"})," ",i>0?e.jsx("span",{className:"text-gray-400",children:e.jsxs(r,{children:["Resend in ",{seconds:i}]})}):e.jsx("button",{type:"button",onClick:j,className:"text-primary font-medium hover:underline transition-colors","aria-label":t("Resend verification code"),children:e.jsx(r,{children:"Resend code"})})]}),e.jsx(P,{className:"mt-4",type:"submit",isLoading:s,color:"primary",variant:"shadow",radius:"full",fullWidth:!0,isDisabled:c.length!==l,"aria-label":t("Verify code button"),children:e.jsx(r,{children:"Verify"})})]})}),e.jsxs("p",{className:"text-center text-sm text-gray-500 font-medium my-4",children:[e.jsx(r,{children:"Back to"})," ",e.jsx(O,{to:g.MAGIC_LOGIN,className:"text-primary font-medium hover:underline transition-colors","aria-label":t("Navigate to login page"),children:e.jsx(r,{children:"Sign in"})})]})]})}const C=t=>b().shape({otp:R(t,l)}),k=(t,u)=>d({title:t("Error"),color:"danger",description:u||t("Invalid OTP. Please try again"),timeout:4e3,shouldShowTimeoutProgress:!0});export{M as default};
